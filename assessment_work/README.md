Аргументація по структурі пайплайнів:


1. process_sales pipeline
Дві окремі Glue джоби для кожного перетворення, один DAG з двома окремими тасками (під кожну Glue джобу). Просто для розуміння архітектури, легко трасувати проблеми в пайплайні (зафейлена таска в airflow одразу покаже, на якому етапі моделювання сталась проблема). Зручно організовувати код для спільної розробки, де за кожну джобу відповідає окремий файл.  

2. process_customers Pipeline
Аналогічно до sales пайплайну - дотримання консистентності у підході на платформі. В разі, якщо один з пайплайнів впаде, silver дані іншого будуть достпні для аналітичних задач. Запускається за розкладом, оскільки отримання даних є регулярним.

3. process_user_profiles
Ручний запуск: Цей пайплайн запускається вручну, оскільки постачальник не має регулярного розкладу доставки цих даних. Оскільки аналітики працюють з голден датасетом в редшифті, то щойно отримується порція даних по user profiles, вони приводяться до необхідного формату на сільвер рівні. Успішне виконання пайплайну тригерить оновлення даних в редшифті. 

4. enrich_user_profiles Pipeline
Це єдиний пайплайн, котрий відпрацьовує безпосередньо в редшифті із використанням SQL-оператора MERGE. Оптимальне рішення для UPSERT-операцій (UPDATE + INSERT), оскільки дозволяє ефективно оновлювати існуючі записи в gold.user_profiles_enriched. Забезпечує ідемпотентність та ефективність оновлення gold шару, уникаючи дублювання та складних послідовностей DELETE/INSERT.

