Аргументація по структурі пайплайнів:


1. process_sales pipeline
Дві окремі Glue джоби для кожного перетворення, об'єднані в одному DAG з двома окремими тасками (під кожну Glue джобу). Просто для розуміння архітектури, легко трасувати проблеми в пайплайні (зафейлена таска в airflow одразу покаже, на якому етапі моделювання сталась проблема), "золота середина" по кількості DAGів. Зручно організовувати код для спільної розробки, де за кожну джобу відповідає окремий файл.  

2. process_customers Pipeline
Аналогічно до sales пайплайну - дотримання консистентності у підході на платформі. В разі, якщо один з пайплайнів впаде, silver дані іншого будуть доступні для аналітичних задач. Запускається за розкладом, оскільки отримання даних є регулярним.

3. process_user_profiles
Цей пайплайн запускається вручну, оскільки постачальник не має регулярного розкладу доставки файлів. Аналітики регулярно працюють з голден датасетом в редшифті, то щойно отримується порція даних по user profiles і вони успішно приводяться до необхідного формату на сільвер рівні, як успішне виконання пайплайну тригерить оновлення даних в редшифті на голден рівні. Аналогічно до інших пайплайнів має окрему glue-джобу на кожне перетворення, а вони об'єднані під одним DAG'ом для зручності трасування. 

4. enrich_user_profiles Pipeline
Це єдиний пайплайн, котрий відпрацьовує безпосередньо в редшифті із використанням SQL-оператора MERGE, а не Glue джоби Оптимальне рішення для UPSERT-операцій (UPDATE + INSERT), оскільки дозволяє ефективно оновлювати існуючі записи в user_profiles_enriched. Забезпечує ідемпотентність та ефективність оновлення gold шару, уникаючи дублювання та складних послідовностей DELETE/INSERT.

Аргументація щодо підходу до побудови сховища даних: 
- використано підхід ближчий до Кімбала, оскільки сховище наповнюється знизу вгору (від бізнес-задачі)
- дані денормалізовані, предметно-орієнтовані
- пріорітезується швидкість отримання результату (відповідь на аналітичне питання) 